<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Meet the talented authors and writers behind The Limelight magazine. Explore their profiles and read their latest articles.">
    <meta name="keywords" content="authors, writers, contributors, the limelight magazine, journalists">
    <meta name="author" content="The Limelight Magazine">
    <title>Authors | The Limelight Magazine</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Roboto:wght@300;400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #fff;
            --secondary-color: #f8f9fa;
            --accent-color: #8B4513; /* Brownish */
            --text-color: #333;
            --light-gray: #e9ecef;
            --border-color: #dee2e6;
            --tag-bg: #f8f0f5;
            --tag-text: #9c27b0; /* Purple */
            --btn-bg: #9c27b0;
            --btn-hover: #7b1fa2;
            --card-shadow: 0 4px 12px rgba(0,0,0,0.08);
            --card-hover-shadow: 0 8px 24px rgba(0,0,0,0.12);
            --transition-speed: 0.3s;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Roboto', sans-serif; background-color: var(--primary-color); color: var(--text-color); line-height: 1.6; }
        .container { max-width: 1200px; margin: 0 auto; padding: 0 20px; }
        a { color: var(--text-color); text-decoration: none; transition: color 0.3s ease; }
        a:hover { color: var(--accent-color); }
        
        /* Loading Animation */
        .loading-bar {
            position: fixed;
            top: 0;
            left: 0;
            height: 3px;
            width: 100%;
            background: linear-gradient(to right, transparent, var(--accent-color), transparent);
            background-size: 200% 100%;
            animation: loading 1.5s infinite linear;
            z-index: 9999;
            display: none;
        }
        @keyframes loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }
        
        /* Header & Navigation */
        .header { padding: 20px 0; text-align: center; border-bottom: 1px solid var(--border-color); position: relative; z-index: 100; }
        .site-title { font-family: 'Playfair Display', serif; font-size: 48px; color: var(--accent-color); margin-bottom: 20px; }
        .nav-menu { display: flex; justify-content: center; list-style: none; margin-bottom: 20px; flex-wrap: wrap; }
        .nav-item { margin: 0 15px; position: relative; }
        .nav-link { display: flex; align-items: center; font-weight: 500; }
        .nav-link i { margin-left: 4px; font-size: 12px; }
        .search-icon { cursor: pointer; }
        
        /* Dropdown Menu for Subcategories */
        .dropdown { position: absolute; top: 100%; left: 0; background: white; min-width: 200px; box-shadow: var(--card-shadow); border-radius: 6px; opacity: 0; visibility: hidden; transform: translateY(10px); transition: all var(--transition-speed) ease; z-index: 100; }
        .nav-item:hover .dropdown { opacity: 1; visibility: visible; transform: translateY(0); }
        .dropdown-item { display: block; padding: 10px 15px; color: var(--text-color); transition: background-color var(--transition-speed); }
        .dropdown-item:hover { background-color: var(--light-gray); color: var(--accent-color); }

        /* Authors Page Styles - Similar to tibaq.in */
        .page-header {
            text-align: center;
            margin: 40px 0;
        }
        .page-title {
            font-family: 'Playfair Display', serif;
            font-size: 36px;
            color: var(--accent-color);
            margin-bottom: 15px;
        }
        .page-subtitle {
            font-size: 18px;
            color: #666;
            max-width: 700px;
            margin: 0 auto;
        }
        
        .authors-container {
            margin-bottom: 60px;
        }
        
        .authors-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 30px;
        }
        
        .author-card {
            background-color: white;
            border: 1px solid var(--border-color);
            border-radius: 0;
            overflow: hidden;
            box-shadow: var(--card-shadow);
            transition: all var(--transition-speed) ease;
            height: 100%;
            display: flex;
            flex-direction: column;
        }
        
        .author-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--card-hover-shadow);
        }
        
        .author-header {
            position: relative;
            height: 200px;
            overflow: hidden;
            background-color: var(--light-gray);
        }
        
        .author-avatar {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 120px;
            height: 120px;
            border-radius: 50%;
            object-fit: cover;
            border: 4px solid white;
            box-shadow: var(--card-shadow);
            z-index: 2;
        }
        
        .author-pattern {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M11 18c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm48 25c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm-43-7c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm63 31c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM34 90c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm56-76c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM12 86c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm28-65c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm23-11c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-6 60c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm29 22c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zM32 63c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm57-13c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-9-21c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM60 91c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM35 41c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM12 60c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2z' fill='%239c27b0' fill-opacity='0.05' fill-rule='evenodd'/%3E%3C/svg%3E");
            opacity: 0.5;
        }
        
        .author-content {
            padding: 80px 20px 30px;
            text-align: center;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }
        
        .author-name {
            font-family: 'Playfair Display', serif;
            font-size: 22px;
            font-weight: 700;
            margin-bottom: 5px;
            color: var(--text-color);
        }
        
        .author-title {
            font-size: 14px;
            color: var(--tag-text);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 15px;
        }
        
        .author-bio {
            font-size: 15px;
            color: #666;
            line-height: 1.6;
            margin-bottom: 20px;
            flex-grow: 1;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        
        .author-stats {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .author-stat {
            text-align: center;
        }
        
        .author-stat-number {
            font-size: 18px;
            font-weight: 700;
            color: var(--accent-color);
        }
        
        .author-stat-label {
            font-size: 12px;
            color: #666;
            text-transform: uppercase;
        }
        
        .author-social-links {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: auto;
        }
        
        .author-social-link {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background-color: var(--light-gray);
            color: var(--text-color);
            transition: all var(--transition-speed) ease;
        }
        
        .author-social-link:hover {
            background-color: var(--btn-bg);
            color: white;
        }
        
        .author-articles-link {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            margin-top: 20px;
            padding: 8px 16px;
            background-color: var(--btn-bg);
            color: white;
            border-radius: 4px;
            font-weight: 500;
            font-size: 14px;
            transition: all var(--transition-speed) ease;
        }
        
        .author-articles-link:hover {
            background-color: var(--btn-hover);
            transform: translateY(-2px);
        }
        
        /* Footer */
        .footer { background-color: var(--secondary-color); padding: 40px 0; border-top: 1px solid var(--border-color); margin-top: 60px; }
        .footer-content { display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; }
        .copyright { color: #666; font-size: 14px; }
        .social-links { display: flex; gap: 15px; }
        
        /* SEARCH OVERLAY STYLES */
        .search-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(255,255,255,0.98); z-index: 3000; flex-direction: column; align-items: center; padding-top: 15vh; }
        .close-search { position: absolute; top: 30px; right: 40px; font-size: 30px; cursor: pointer; }
        .search-overlay input { font-family: 'Playfair Display', serif; font-size: 40px; border: none; border-bottom: 2px solid var(--text-color); background: transparent; outline: none; text-align: center; width: 80%; max-width: 600px; }
        #searchResults { margin-top: 2rem; width: 80%; max-width: 600px; text-align: left; }
        .search-result-item {
            display: flex;
            align-items: center;
            padding: 12px;
            border-bottom: 1px solid var(--border-color);
            transition: background-color var(--transition-speed);
        }
        .search-result-item:hover {
            background-color: var(--light-gray);
        }
        .search-result-thumbnail {
            width: 60px;
            height: 60px;
            object-fit: cover;
            border-radius: 4px;
            margin-right: 15px;
        }
        .search-result-text {
            flex: 1;
        }
        .search-result-title {
            font-weight: 500;
            margin-bottom: 5px;
        }
        .search-result-excerpt {
            font-size: 14px;
            color: #666;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 400px;
        }

        @media (max-width: 768px) { 
            .site-title { font-size: 36px; } 
            .authors-grid { grid-template-columns: 1fr; }
            .footer-content { flex-direction: column; text-align: center; gap: 1rem; }
            .dropdown { position: static; opacity: 1; visibility: visible; transform: none; box-shadow: none; background: var(--light-gray); margin-top: 5px; border-radius: 0; }
            .nav-item { margin-bottom: 10px; }
            .search-result-thumbnail {
                width: 50px;
                height: 50px;
            }
        }
    </style>
</head>
<body>
    <!-- Loading Animation -->
    <div class="loading-bar" id="loadingBar"></div>
    
    <header class="header">
        <div class="site-title">THE LIMELIGHT</div>
        <nav class="container">
            <ul class="nav-menu" id="categoryNav"></ul>
        </nav>
    </header>

    <main class="container">
        <div class="page-header">
            <h1 class="page-title">Our Authors</h1>
            <p class="page-subtitle">Meet the talented writers who contribute to The Limelight with their unique perspectives and insightful content.</p>
        </div>
        
        <div class="authors-container">
            <div class="authors-grid" id="authorsGrid"></div>
        </div>
    </main>

    <footer class="footer">
        <div class="footer-content container">
            <div class="copyright">Â© 2025 The Limelight Online. All rights reserved.</div>
            <div class="social-links">
                <a href="#" class="social-link"><i class="fab fa-facebook-f"></i></a>
                <a href="#" class="social-link"><i class="fab fa-twitter"></i></a>
                <a href="#" class="social-link"><i class="fab fa-instagram"></i></a>
            </div>
        </div>
    </footer>
    
    <div class="search-overlay" id="searchOverlay">
        <span class="close-search" id="closeSearch">&times;</span>
        <input type="text" id="searchInput" placeholder="Search...">
        <div id="searchResults"></div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script>
        const SUPABASE_URL = 'https://whklfmxjknhucguzvpob.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Indoa2xmbXhqa25odWNndXp2cG9iIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTgyOTY5MjIsImV4cCI6MjA3Mzg3MjkyMn0.5Y2an8aYFc5wY64VmRJmnblYBPwLLs_CR9UXJ4XuzjM';
        const supabaseClient = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

        // --- DOM Elements ---
        const authorsGrid = document.getElementById('authorsGrid');
        const loadingBar = document.getElementById('loadingBar');

        // --- Show/Hide Loading Animation ---
        function showLoading() {
            loadingBar.style.display = 'block';
        }

        function hideLoading() {
            loadingBar.style.display = 'none';
        }

        // --- DATA FETCHING ---
        async function fetchCategories() {
            showLoading();
            const { data: categories, error } = await supabaseClient.from('categories').select('*').is('parent_id', null).order('name');
            if (error) {
                console.error('Error fetching categories:', error);
                hideLoading();
                return;
            }
            
            // Fetch subcategories for each category
            const navItems = await Promise.all(categories.map(async (category) => {
                const { data: subcategories } = await supabaseClient.from('categories').select('*').eq('parent_id', category.id).order('name');
                return {
                    category,
                    subcategories: subcategories || []
                };
            }));
            
            const nav = document.getElementById('categoryNav');
            nav.innerHTML = `
                <li class="nav-item"><a href="index.html" class="nav-link">Home</a></li>
                ${navItems.map(item => `
                    <li class="nav-item">
                        <a href="index.html?categories=${item.category.slug}" class="nav-link">
                            ${item.category.name}
                            ${item.subcategories.length > 0 ? '<i class="fas fa-chevron-down"></i>' : ''}
                        </a>
                        ${item.subcategories.length > 0 ? `
                            <div class="dropdown">
                                ${item.subcategories.map(sub => `
                                    <a href="index.html?categories=${sub.slug}" class="dropdown-item">${sub.name}</a>
                                `).join('')}
                            </div>
                        ` : ''}
                    </li>
                `).join('')}
                <li class="nav-item"><a href="authors.html" class="nav-link">Authors</a></li>
                <li class="nav-item"><a href="contact.html" class="nav-link">Contact</a></li>
                <li class="nav-item"><a href="#" class="nav-link search-icon" id="openSearch"><i class="fas fa-search"></i></a></li>`;
            
            document.getElementById('openSearch').addEventListener('click', openSearchOverlay);
            hideLoading();
        }

        async function fetchAuthors() {
            showLoading();
            const { data: authors, error } = await supabaseClient
                .from('authors')
                .select('*')
                .order('full_name');
            
            if (error) {
                console.error('Error fetching authors:', error);
                hideLoading();
                return;
            }
            
            // For each author, fetch their article count
            const authorsWithCounts = await Promise.all(authors.map(async (author) => {
                const { count } = await supabaseClient
                    .from('posts')
                    .select('*', { count: 'exact', head: true })
                    .eq('author_id', author.id);
                
                return {
                    ...author,
                    articleCount: count || 0
                };
            }));
            
            authorsGrid.innerHTML = authorsWithCounts.map(author => `
                <div class="author-card">
                    <div class="author-header">
                        <div class="author-pattern"></div>
                        <img src="${author.avatar_url || 'https://via.placeholder.com/120'}" alt="${author.full_name}" class="author-avatar" onerror="this.src='https://via.placeholder.com/120'">
                    </div>
                    <div class="author-content">
                        <h2 class="author-name">${author.full_name}</h2>
                        <div class="author-title">Contributing Writer</div>
                        <p class="author-bio">${author.bio || 'No bio available for this author.'}</p>
                        <div class="author-stats">
                            <div class="author-stat">
                                <div class="author-stat-number">${author.articleCount}</div>
                                <div class="author-stat-label">Articles</div>
                            </div>
                        </div>
                        <div class="author-social-links">
                            <a href="#" class="author-social-link"><i class="fab fa-twitter"></i></a>
                            <a href="#" class="author-social-link"><i class="fab fa-linkedin-in"></i></a>
                            <a href="#" class="author-social-link"><i class="fab fa-instagram"></i></a>
                        </div>
                        <a href="index.html?author=${author.id}" class="author-articles-link">
                            View Articles <i class="fas fa-arrow-right"></i>
                        </a>
                    </div>
                </div>
            `).join('');
            
            hideLoading();
        }

        // --- SEARCH LOGIC ---
        const searchOverlay = document.getElementById('searchOverlay');
        function openSearchOverlay() { 
            searchOverlay.style.display = 'flex'; 
            document.getElementById('searchInput').focus(); 
        }
        
        let searchTimeout;
        async function performSearch() {
            const term = document.getElementById('searchInput').value;
            const resultsContainer = document.getElementById('searchResults');
            
            // Clear previous timeout
            clearTimeout(searchTimeout);
            
            if (term.length < 3) { 
                resultsContainer.innerHTML = ''; 
                return; 
            }
            
            // Show loading indicator
            resultsContainer.innerHTML = '<p style="text-align: center; padding: 20px;">Searching...</p>';
            
            // Set a new timeout to avoid too many requests
            searchTimeout = setTimeout(async () => {
                const { data } = await supabaseClient
                    .from('posts')
                    .select('id, title, slug, image_url, excerpt')
                    .textSearch('title', `'${term}'`);
                
                if (data && data.length > 0) {
                    resultsContainer.innerHTML = data.map(p => `
                        <a href="article.html?post=${p.slug}" class="search-result-item">
                            <img src="${p.image_url}" alt="${p.title}" class="search-result-thumbnail">
                            <div class="search-result-text">
                                <div class="search-result-title">${p.title}</div>
                                <div class="search-result-excerpt">${p.excerpt || 'No excerpt available'}</div>
                            </div>
                        </a>
                    `).join('');
                } else {
                    resultsContainer.innerHTML = '<p style="text-align: center; padding: 20px;">No results found.</p>';
                }
            }, 300); // 300ms delay
        }

        // --- EVENT LISTENERS ---
        document.addEventListener('DOMContentLoaded', () => {
            fetchCategories();
            fetchAuthors();
        });

        document.getElementById('closeSearch').addEventListener('click', () => searchOverlay.style.display = 'none');
        document.getElementById('searchInput').addEventListener('input', performSearch);
        document.getElementById('searchResults').addEventListener('click', (e) => {
            if (e.target.closest('.search-result-item')) {
                e.preventDefault();
                window.location.href = e.target.closest('.search-result-item').href;
            }
        });
        document.addEventListener('keydown', (e) => {
            if(e.key === 'Escape') {
                searchOverlay.style.display = 'none';
            }
        });
    </script>
</body>
</html>
